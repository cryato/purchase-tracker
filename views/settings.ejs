<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
	<title><%= t('settings.title') %></title>
    <link rel="stylesheet" href="/styles.css" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0f172a">
</head>
<body>
    <div class="container">
        <div class="card">
			<h1 class="title"><%= t('settings.title') %></h1>
            <form action="/settings" method="post">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                <div>
					<label for="weeklyBudget"><%= t('settings.weekly_budget') %></label>
                    <input id="weeklyBudget" name="weeklyBudget" type="number" step="0.01" inputmode="decimal" value="<%= weeklyBudget %>" required />
                </div>
                <div>
					<label for="currency"><%= t('settings.currency_code') %></label>
                    <input id="currency" name="currency" type="text" value="<%= currency %>" required />
                </div>
                <div>
                    <label for="language"><%= (typeof t === 'function' ? t('settings.language') : 'Language') %></label>
                    <select id="language" name="language">
                        <% (languages || []).forEach(function(opt){ %>
                            <option value="<%= opt.code %>" <%= (language === opt.code) ? 'selected' : '' %>><%= opt.name %></option>
                        <% }) %>
                    </select>
                </div>
				<div class="actions">
					<a class="btn secondary" href="/"><%= t('settings.cancel') %></a>
					<button class="btn" type="submit"><%= t('settings.save') %></button>
				</div>
            </form>
            <hr style="border-color:#1f2937; margin:16px 0" />
            <% if (isAdmin) { %>
                <div>
                    <h2 class="title" style="font-size:18px; margin:0 0 8px 0"><%= t('settings.public_link_title') || 'Public read-only link' %></h2>
                    <% if (hasPublicLink) { %>
                        <p class="subtle" style="word-break:break-all"><%= publicLinkUrl %></p>
                        <form action="/settings/public-link/revoke" method="post" style="display:inline-block; margin-top:8px">
                            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                            <button class="btn" type="submit"><%= t('settings.public_link_revoke') || 'Revoke link' %></button>
                        </form>
                    <% } else { %>
                        <form action="/settings/public-link/create" method="post" style="display:inline-block; margin-top:8px">
                            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                            <button class="btn" type="submit"><%= t('settings.public_link_create') || 'Create link' %></button>
                        </form>
                    <% } %>
                    <p class="subtle" style="margin-top:8px"><%= t('settings.public_link_help') || 'People with the link can only view the main screen and weekly details. They cannot edit or access trash.' %></p>
                </div>
            <% } %>
            <hr style="border-color:#1f2937; margin:16px 0" />
			<form action="/sessionLogout" method="post">
                <input type="hidden" name="_csrf" value="<%= csrfToken %>">
				<button class="btn secondary" type="submit"><%= t('settings.logout') %></button>
            </form>
        </div>
    </div>
</body>
</html>


